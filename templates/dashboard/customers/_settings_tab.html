{% load static %}
<div class="section-header" data-aos="fade-up">
  <h2>تنظیمات حساب کاربری</h2>
</div>

<div class="settings-content">
  <!-- Personal Information -->
  <div class="settings-section" data-aos="fade-up">
    <h3>اطلاعات شخصی</h3>
    <form method="POST" action="{% url 'dashboard:profile_settings' %}" enctype="multipart/form-data" class="settings-form">
      {% csrf_token %}

      <!-- Profile Image Upload -->

      <div class="row g-3">
        <div class="col-md-6">
          <label for="id_first_name" class="form-label">نام</label>
          <input type="text" name="first_name" class="form-control" id="id_first_name" value="{{ profile.first_name }}" />
          {% if form.first_name.errors %}
            <div class="invalid-feedback d-block">{{ form.first_name.errors.0 }}</div>
          {% endif %}
        </div>
        <div class="col-md-6">
          <label for="id_last_name" class="form-label">نام خانوادگی</label>
          <input type="text" name="last_name" class="form-control" id="id_last_name" value="{{ profile.last_name }}" />
          {% if form.last_name.errors %}
            <div class="invalid-feedback d-block">{{ form.last_name.errors.0 }}</div>
          {% endif %}
        </div>
        <div class="col-md-6">
          <label for="id_email" class="form-label">ایمیل</label>
          <input type="email" class="form-control" id="id_email" value="{{ user.email }}" disabled />
          <small class="form-text text-muted">ایمیل قابل تغییر نیست</small>
        </div>
        <div class="col-md-6">
          <label for="id_phone_number" class="form-label">شماره تلفن</label>
          <input type="tel" name="phone_number" class="form-control" id="id_phone_number" value="{{ profile.phone_number }}" placeholder="09123456789" />
          {% if form.phone_number.errors %}
            <div class="invalid-feedback d-block">{{ form.phone_number.errors.0 }}</div>
          {% endif %}
        </div>
      </div>

      <div class="form-buttons">
        <button type="submit" class="btn btn-primary"><i class="bi bi-check-circle"></i> ذخیره تغییرات</button>
      </div>
    </form>
  </div>

  <!-- Security Settings -->
  <div class="settings-section" data-aos="fade-up" data-aos-delay="100">
    <h3>امنیت</h3>
    <form method="POST" action="{% url 'dashboard:account_settings' %}" class="settings-form">
      {% csrf_token %}
      <input type="hidden" name="change_password" value="1" />

      <div class="row g-3">
        <div class="col-md-12">
          <label for="id_current_password" class="form-label">رمز عبور فعلی</label>
          <input type="password" name="current_password" class="form-control" id="id_current_password" required />
        </div>
        <div class="col-md-6">
          <label for="id_new_password" class="form-label">رمز عبور جدید</label>
          <input type="password" name="new_password" class="form-control" id="id_new_password" required />
          <small class="form-text text-muted">حداقل 8 کاراکتر</small>
        </div>
        <div class="col-md-6">
          <label for="id_confirm_password" class="form-label">تکرار رمز عبور جدید</label>
          <input type="password" name="confirm_password" class="form-control" id="id_confirm_password" required />
        </div>
      </div>

      <div class="form-buttons">
        <button type="submit" class="btn btn-primary"><i class="bi bi-shield-check"></i> تغییر رمز عبور</button>
      </div>
    </form>
  </div>

  <!-- Account Information -->
  <div class="settings-section" data-aos="fade-up" data-aos-delay="200">
    <h3>اطلاعات حساب</h3>
    <div class="info-list">
      <div class="info-item">
        <span class="info-label">تاریخ عضویت:</span>
        <span class="info-value">{{ user.created_date|date:'Y/m/d' }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">آخرین بروزرسانی:</span>
        <span class="info-value">{{ profile.updated_date|date:'Y/m/d' }}</span>
      </div>
      <div class="info-item">
        <span class="info-label">وضعیت حساب:</span>
        <span class="info-value">
          {% if user.is_verified %}
            <span class="badge bg-success">تایید شده</span>
          {% else %}
            <span class="badge bg-warning">در انتظار تایید</span>
          {% endif %}
        </span>
      </div>
    </div>
  </div>
</div>

<script>
  function previewImage(input) {
    if (input.files && input.files[0]) {
      const reader = new FileReader()
      reader.onload = function (e) {
        document.getElementById('profile-preview').src = e.target.result
      }
      reader.readAsDataURL(input.files[0])
    }
  }
</script>
